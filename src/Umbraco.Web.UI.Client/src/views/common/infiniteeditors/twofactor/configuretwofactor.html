<div ng-controller="Umbraco.Editors.ConfigureTwoFactorController as vm">

  <umb-editor-view>

    <umb-editor-header name="vm.title" name-locked="true" hide-alias="true" hide-icon="true" hide-description="true">
    </umb-editor-header>

    <umb-editor-container>

      <umb-box ng-repeat="provider in vm.providers">

        <umb-box-content>

          <umb-box-header title="{{provider.providerName}}"></umb-box-header>

          <umb-control-group>

            <div ng-if="provider.isEnabledOnUser">
              <div ng-if="!provider.showOptions">
                <p>
                  <localize key="user_2faProviderIsEnabled"></localize>
                  <umb-icon icon="icon-check" class="success"></umb-icon>
                </p>

                <umb-button type="button" ng-if="!model.isCurrentUser" button-style="[warning,block]"
                  action="vm.disable(provider.providerName)" label="Disable" label-key="actions_disable" size="m"
                  state="vm.buttonState">
                </umb-button>
              </div>

              <div ng-if="model.isCurrentUser">
                <umb-button type="button" ng-click="provider.showOptions = true" ng-if="!provider.showOptions"
                  label="Options" label-key="general_options">
                </umb-button>

                <div ng-if="provider.showOptions">
                  <div class="h5">
                    <localize key="actions_disable"></localize>
                  </div>

                  <form method="POST" ng-submit="vm.disableWithCode(provider.providerName)">

                    <p>
                      <localize key="user_2faDisableText"></localize>
                    </p>

                    <umb-control-group>
                      <label for="2facode_{{$index}}" class="control-label">
                        <localize key="login_2faCodeInput">Verification code</localize>
                      </label>

                      <div class="controls">
                        <input umb-auto-focus id="2facode_{{$index}}" class="-full-width-input input-xlarge" type="text"
                          name="token" inputmode="numeric" autocomplete="one-time-code" ng-model="vm.code"
                          localize="placeholder" placeholder="@login_2faCodeInputHelp" aria-required="true"
                          no-dirty-check />
                      </div>
                    </umb-control-group>

                    <umb-button button-style="[warning,block]" label="Disable" label-key="actions_disable" size="m"
                      disabled="vm.code.length === 0" state="vm.buttonState">
                    </umb-button>
                  </form>
                </div>
              </div>
            </div>

            <umb-button type="button" ng-if="!provider.isEnabledOnUser" button-style="[action,block]"
              disabled="!model.isCurrentUser" action="vm.enable(provider.providerName)" label="Enable"
              label-key="actions_enable" size="m" state="vm.buttonState">
            </umb-button>

          </umb-control-group>

        </umb-box-content>
      </umb-box>
    </umb-editor-container>

    <umb-editor-footer>

      <umb-editor-footer-content-right>

        <umb-button type="button" button-style="link" label-key="general_close" shortcut="esc" action="vm.close()">
        </umb-button>

      </umb-editor-footer-content-right>

    </umb-editor-footer>

  </umb-editor-view>
</div>
